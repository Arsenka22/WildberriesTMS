{"id":"modules/cart.js","dependencies":[{"name":"C:\\WildberriesTMS\\package.json","includedInParent":true,"mtime":1750694789472},{"name":"./state.js","loc":{"line":1,"column":22,"index":22},"parent":"C:\\WildberriesTMS\\src\\modules\\cart.js","resolved":"C:\\WildberriesTMS\\src\\modules\\state.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initCart = initCart;\nvar _state = require(\"./state.js\");\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction initCart() {\n  var busketButton = document.getElementById(\"busketButton\");\n  var cartElement = document.getElementById(\"cart\");\n  var saveCart = function saveCart() {\n    return localStorage.setItem(\"cartData\", JSON.stringify(_state.state.cartData));\n  };\n  function renderCart() {\n    var _document$getElementB, _document$getElementB2;\n    if (!cartElement) return;\n    cartElement.innerHTML = \"\\n      <div class=\\\"flex justify-between items-center mb-4\\\">\\n        <h2 class=\\\"text-2xl font-bold text-white\\\">\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430</h2>\\n        <button id=\\\"closeCart\\\" class=\\\"text-white text-2xl cursor-pointer hover:text-gray-300\\\">\\u2715</button>\\n      </div>\\n      <div id=\\\"cart-items\\\" class=\\\"flex-grow\\\"></div>\\n      <div id=\\\"cart-total\\\" class=\\\"text-white font-bold mt-4 pt-4 border-t border-gray-600 text-xl\\\"></div>\";\n    var cartItems = document.getElementById(\"cart-items\");\n    var cartTotal = document.getElementById(\"cart-total\");\n    (_document$getElementB = document.getElementById(\"closeCart\")) === null || _document$getElementB === void 0 || _document$getElementB.addEventListener(\"click\", function () {\n      return cartElement.classList.add(\"hidden\");\n    });\n    if (!_state.state.cartData.length) {\n      cartItems.innerHTML = '<p class=\"text-white text-center py-4\">Корзина пуста</p>';\n      cartTotal.textContent = \"\";\n      return;\n    }\n    var total = 0;\n    _state.state.cartData.forEach(function (item) {\n      var itemTotal = item.newPrice * item.quantity;\n      total += itemTotal;\n      cartItems.innerHTML += \"\\n        <div class=\\\"cart-item mb-3 p-3 bg-gray-600 rounded-lg\\\">\\n          <div class=\\\"flex justify-between items-start\\\">\\n            <div class=\\\"flex-1\\\">\\n              <h3 class=\\\"font-bold text-white\\\">\".concat(item.name, \"</h3>\\n              <div class=\\\"flex justify-between mt-2\\\">\\n                <div>\\n                  <span class=\\\"text-white\\\">\\u0426\\u0435\\u043D\\u0430: \").concat(item.newPrice, \" \\u0440\\u0443\\u0431.</span>\\n                  <div class=\\\"flex items-center mt-1\\\">\\n                    <button class=\\\"decrease-btn text-white bg-gray-500 rounded w-6 h-6 flex items-center justify-center\\\" data-id=\\\"\").concat(item.id, \"\\\">-</button>\\n                    <span class=\\\"text-white mx-2\\\">\").concat(item.quantity, \"</span>\\n                    <button class=\\\"increase-btn text-white bg-gray-500 rounded w-6 h-6 flex items-center justify-center\\\" data-id=\\\"\").concat(item.id, \"\\\">+</button>\\n                  </div>\\n                </div>\\n                <span class=\\\"font-bold text-white\\\">\").concat(itemTotal, \" \\u0440\\u0443\\u0431.</span>\\n              </div>\\n            </div>\\n            <button class=\\\"remove-item text-red-400 hover:text-red-300 ml-4\\\" data-id=\\\"\").concat(item.id, \"\\\">\\u2715</button>\\n          </div>\\n        </div>\");\n    });\n    cartTotal.innerHTML = \"\\n      <div class=\\\"flex justify-between\\\"><span>\\u0418\\u0442\\u043E\\u0433\\u043E:</span><span>\".concat(total, \" \\u0440\\u0443\\u0431.</span></div>\\n      <button id=\\\"checkout-btn\\\" class=\\\"w-full mt-4 bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700\\\">\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437</button>\");\n    cartItems.querySelectorAll(\".remove-item\").forEach(function (btn) {\n      return btn.addEventListener(\"click\", function (e) {\n        removeFromCart(+e.currentTarget.dataset.id);\n      });\n    });\n    cartItems.querySelectorAll(\".decrease-btn\").forEach(function (btn) {\n      return btn.addEventListener(\"click\", function (e) {\n        updateQuantity(+e.currentTarget.dataset.id, \"decrease\");\n      });\n    });\n    cartItems.querySelectorAll(\".increase-btn\").forEach(function (btn) {\n      return btn.addEventListener(\"click\", function (e) {\n        updateQuantity(+e.currentTarget.dataset.id, \"increase\");\n      });\n    });\n    (_document$getElementB2 = document.getElementById(\"checkout-btn\")) === null || _document$getElementB2 === void 0 || _document$getElementB2.addEventListener(\"click\", function () {\n      alert(\"Заказ оформлен! Спасибо за покупку!\");\n      _state.state.cartData = [];\n      saveCart();\n      cartElement.classList.add(\"hidden\");\n    });\n  }\n  var showCart = function showCart() {\n    renderCart();\n    cartElement.classList.remove(\"hidden\");\n  };\n  function showNotification(msg) {\n    var _note;\n    var note = document.getElementById(\"cart-notification\");\n    (_note = note) === null || _note === void 0 || _note.remove();\n    note = document.createElement(\"div\");\n    note.id = \"cart-notification\";\n    note.textContent = msg;\n    note.className = \"fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow-lg z-50 animate-fade-in\";\n    document.body.appendChild(note);\n    setTimeout(function () {\n      note.classList.replace(\"animate-fade-in\", \"animate-fade-out\");\n      setTimeout(function () {\n        return note.remove();\n      }, 300);\n    }, 2000);\n  }\n  function addToCart(id) {\n    var product = _state.state.allProducts.find(function (p) {\n      return p.id === id;\n    });\n    if (!product) return;\n    var existing = _state.state.cartData.find(function (i) {\n      return i.id === id;\n    });\n    existing ? existing.quantity++ : _state.state.cartData.push(_objectSpread(_objectSpread({}, product), {}, {\n      quantity: 1\n    }));\n    showNotification(\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u043E \\u0432 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443: \".concat(product.name));\n    renderCart();\n    saveCart();\n  }\n  function removeFromCart(id) {\n    _state.state.cartData = _state.state.cartData.filter(function (i) {\n      return i.id !== id;\n    });\n    renderCart();\n    saveCart();\n  }\n  function updateQuantity(id, action) {\n    var item = _state.state.cartData.find(function (i) {\n      return i.id === id;\n    });\n    if (!item) return;\n    action === \"increase\" ? item.quantity++ : item.quantity = Math.max(1, item.quantity - 1);\n    renderCart();\n    saveCart();\n  }\n  busketButton === null || busketButton === void 0 || busketButton.addEventListener(\"click\", showCart);\n  return {\n    addToCart: addToCart,\n    renderCart: renderCart,\n    removeFromCart: removeFromCart,\n    updateQuantity: updateQuantity\n  };\n}"},"sourceMaps":null,"error":null,"hash":"4ba1784f5e147a342877586231fbabf6","cacheData":{"env":{}}}